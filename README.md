# proxy-rotator

## Навигация
- [Документация API](#документация-api)
    - [Описание](#описание)
    - [Общие доступные методы API](#общие-доступные-методы-api)
    - [Доступные методы прокси API](#доступные-методы-прокси-api)
    - [Доступные методы аккаунт API](#доступные-методы-аккаунт-api)
- [База данных](#база-данных)
    -[Коллекция 'Proxies'](#коллекция-proxies)
    -[Коллекция 'Accounts'](#коллекция-accounts)
- [Установка и запуск](#установка-и-запуск)
- [Зависимости](#зависимости)

# Документация API

## Описание
API предназначено для управления процессом ротации прокси и аккаунтов ВБ. Работает во взаимосвязи с базой данных MongoDB.

## База данных

### Коллекция 'Proxies'
Коллекция 'Proxies' хранит в себе информацию о доступных мобильных прокси

- Формат данных в коллекции:

| Значение | Тип данных | Описание |
| --- | --- | --- |
| _id | ObjectId | Уникальный идентификатор прокси в БД. |
| proxy | String | IP-адрес и порт прокси-сервера. |
| status | String | Статус прокси ("free"/"busy"). |
| lastUsedIP |	String	| Последний использованный IP-адрес (по необходимости). |

### Коллекция 'Accounts'
Коллекция 'Proxies' хранит в себе информацию о доступных мобильных прокси

- Формат данных в коллекции:

| Значение | Тип данных | Описание |
| --- | --- | --- |
| _id | ObjectId | Уникальный идентификатор аккаунта в БД. |
| phone | String | Номер телефона, связанный с аккаунтом. |
| name | String | Имя владельца аккаунта. |
| name |	String	| Пол владельца аккаунта. |
| status |	String	| Статус аккаунта ("free"/"busy"). |

## Общие доступные методы API
| Конечная точка | Тип запроса | Тело запроса | Пример ответа на запрос |
| --- | --- | --- | --- |
| `/api/` |	GET	| Нет |	`{"message": "Привет от API!"}` |
| `/api/restartDatabase` |	GET	| Нет | Успешный ответ: `{"success": true, "message": "Успешно подключились к базе данных"}` <br> Ошибка подключения: `{"success": false, "message": "Подключение к базе данных не может быть установлено"}` <br> Ошибка сервера:  `{"success": false, "message": "Произошла ошибка при подключении к базе данных"}` |
## Доступные методы прокси API
| Конечная точка | Тип запроса | Тело запроса | Пример ответа на запрос |
| --- | --- | --- | --- |
| `/api/proxy/proxies/` |	GET	| Нет |	Список прокси в формате JSON |
| `/api/proxy/proxies/string/` |	GET	| `{"proxyString": "177.177.179.27:30777:iparchitect_777_71_08_23:nNFiaQ9iBbzBnkhr"}`|	Прокси в формате JSON или ошибка 404 |
| `/api/proxy/proxies/:id` |	GET	| Нет|	Прокси в формате JSON или ошибка 404 |
| `/api/proxy/random-proxy` |	GET	| Нет|	Прокси в формате JSON с последним IP или ошибка 404 |
| `/api/proxy/proxies/:id` |	PUT	| Тело запроса содержит обновленные данные прокси |	Сообщение об успешном обновлении прокси |
| `/api/proxy/proxies` |	POST	| Тело запроса содержит новую прокси |	Сообщение об успешном обновлении прокси |
| `/api/proxy/proxies/end-cycle/` |	PUT	| `{ "proxyString": "proxyString" }` |	Сообщение о завершении цикла прокси и последний использованный IP или ошибка 500 |
| `/api/proxy/proxies/:id` |	DELETE	| нет |	Сообщение об успешном удалении прокси |


## Доступные методы аккаунт API
| Конечная точка | Тип запроса | Тело запроса | Пример ответа на запрос |
| --- | --- | --- | --- |
| `/api/account/accounts/phone/` |	GET	| `{"phone": "+22222"}` |	Аккаунт в формате JSON |
| `/api/account/accounts/id` |	GET	| Нет |	Аккаунт в формате JSON |
| `/api/account/accounts` |	GET	| Нет|	Все Аккаунты в формате JSON |
| `/api/account/accounts` |	POST	| Тело запроса содержит новый аккаунт|	Сообщение об успешном добавлении аккаунта |
| `/api/account/accounts/:id` |	PUT	| Тело запроса содержит обновленные данные аккаунта |	Сообщение об успешном добавлении аккаунта |
| `/api/account/accounts/:id` |	DELETE	| Нет |	Сообщение об успешном добавлении аккаунта |

## Доступные методы API Лайкера
| Конечная точка | Тип запроса | Тело запроса | Пример ответа на запрос |
| --- | --- | --- | --- |
| `/api/like` |	POST	| `{"likeId": "like_id_here"}` |	res.status(200)/res.status(400)/res.status(500) и сообщение о принятии в работу |

## Установка и запуск

1. Установите зависимости с помощью команды `npm install`.
2. Запустите сервер с помощью команды `npm run start`.
3. API будет доступно по адресу `http://localhost:3000`.

## Зависимости

Для работы API необходимы:

- Node.js версии 10.0.0 и выше
- MongoDB
- Доступ к интернету для подключения к MongoDB